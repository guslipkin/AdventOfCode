---
title: "Day 3: Crossed Wires"
format: html
---

```{r}
#| message: false
library(mistlecode)
```

```{r}
dtM <-
  readLines("input.txt") |>
  lapply(\(x) {
    strsplit(x, ",")[[1]] |>
      data.frame() |>
      `colnames<-`(c("col")) |>
      separate(col = "col", into = c("dir", "mag"), sep = 1) |>
      mutate(mag = as.integer(mag))
  })
```

## Part 1

```{r}
dtM <- lapply(dtM, expand_directions)

dtM[[1]] <- follow_directions(dtM[[1]], 0, 0)
dtM[[2]] <- follow_directions(dtM[[2]], 0, 0)

inner_join(dtM[[1]], dtM[[2]], by = c("row", "col")) |>
  lapply(abs) |>
  data.frame() |>
  mutate(dist = row + col) |>
  arrange(dist) |>
  head(1) |>
  pull(dist)
```

## Part 2

```{r}
dtM <-
  readLines("input.txt") |>
  lapply(\(x) {
    strsplit(x, ",")[[1]] |>
      data.frame() |>
      `colnames<-`(c("col")) |>
      separate(col = "col", into = c("dir", "mag"), sep = 1) |>
      mutate(mag = as.integer(mag), step = row_number())
  })

dtM <- lapply(dtM, expand_directions)

dtM[[1]] <- follow_directions(dtM[[1]], 0, 0)
dtM[[2]] <- follow_directions(dtM[[2]], 0, 0)

inner_join(dtM[[1]], dtM[[2]], by = c("row", "col")) |>
  lapply(abs) |>
  data.frame() |>
  mutate(dist = row + col) |>
  arrange(dist) |>
  head(1) |>
  pull(dist)
```

