---
title: "07: "
format: html
---

```{r}
#| message: false
library(mistlecode)

options(scipen = 999)
```

```{r}
dt <-
  'input.txt' |>
  readLines() |>
  stringr::str_extract_all(' ([A-Z]{1}) ') |>
  purrr::map(\(x) stringr::str_remove_all(x, ' ')) |>
  unlist() |>
  matrix(ncol = 2, byrow = TRUE) |>
  tibble::as_tibble(.name_repair = 'minimal') |>
  setNames(c('x', 'y'))
```

## Part 1

KVBCJGHMZSDQRXFYOAULPIEWTN
KCJMSDVBHXFQRYGZOAULPIEWTN

```{r}
recurse <- function(steps, node, path = c()) {
  path <- unique(c(node, path))
  opts <-
    steps |>
    dplyr::filter(.data$y == node) |>
    dplyr::pull(.data$x) |>
    sort() |>
    rev()
  if (length(opts) == 0) return(path)
  for (o in opts) {
    path <- recurse(steps, o, path)
  }
  return(path)
}
start <- dt$y[which(!(dt$y %in% dt$x))] |> unique()
dt |>
  recurse(start) |>
  paste0(collapse = '')
```
