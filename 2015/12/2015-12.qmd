---
title: "2015-12: JSAbacusFramework.io"
---

```{r}
#| message: false
library(mistlecode)
library(jsonlite)
dt <- readLines("input.json")
```

## Part 1

Surprisingly easy. Just had a small regex typo with `?` instead of `+`.

```{r}
dt |>
  str_extract_all("(-?[0-9]+)") |>
  unlist() |>
  as.numeric() |>
  sum(na.rm = TRUE)
```

## Part 2

```{r}
replace <- function(x) {
  y <- str_remove_all(x, "(\\{[a-z:,0-9\\-\\[\\]\\{\\}]+:red[a-z:,0-9\\-\\[\\]\\{\\}]+\\})")
  if (x == y) { return(y) } else { return(replace(y)) }
}

dt |>
# '{e:green,a:77,d:{c:violet,a:yellow,b:violet},c:yellow,h:red,b:144,g:{a:[yellow,-48,72,87,,,orange,171,162]},f:orange,i:orange},49,[{c:{e:violet,a:-44,d:115,c:117,h:194,b:{e:-17,a:172,d:green,c:197,h:53,b:106,g:violet,f:-10},g:red,f:orange}' |>
  str_remove_all('"') |>
  replace() |>
  str_extract_all("(-?[0-9]+)") |>
  unlist() |>
  as.numeric() |>
  sum(na.rm = TRUE)
```

> 186
< 164496