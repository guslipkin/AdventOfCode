{
  "hash": "b8b3d7e0236a76c01f47facfcdcf953a",
  "result": {
    "markdown": "---\ntitle: \"2021-11: Dumbo Octopus\"\nformat: html\n---\n\n::: {.cell hash='2021-11_cache/html/unnamed-chunk-1_15a72a1143284b6f2bef284faff04f9a'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──\n✔ ggplot2 3.4.0      ✔ purrr   0.3.5 \n✔ tibble  3.1.8      ✔ dplyr   1.0.10\n✔ tidyr   1.2.1      ✔ stringr 1.4.1 \n✔ readr   2.1.3      ✔ forcats 0.5.2 \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n```\n:::\n\n```{.r .cell-code}\nlibrary(data.table)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'data.table'\n\nThe following objects are masked from 'package:dplyr':\n\n    between, first, last\n\nThe following object is masked from 'package:purrr':\n\n    transpose\n```\n:::\n:::\n\n::: {.cell hash='2021-11_cache/html/unnamed-chunk-2_504354b75b7a550608ea1b213291f621'}\n\n```{.r .cell-code}\noctopusM <- readLines(\"input.txt\")\n```\n:::\n\n\n## Part 1\n\n\n::: {.cell hash='2021-11_cache/html/unnamed-chunk-3_392fad92326f6fa629b3509806d193d4'}\n\n```{.r .cell-code}\noctopus <- octopusM |>\n  strsplit(\"\") %>%\n  do.call(rbind, .) |>\n  as.matrix() |>\n  apply(1, as.numeric) |>\n  t()\n\noctopusCol <- ncol(octopus)\noctopusRow <- nrow(octopus)\n\nflash_counter <- 0\n\nget_adjacent <- function(xx, yy, ncol, nrow) {\n  x <- xx; y <- yy\n  x <- (x-1):(x+1); y <- (y-1):(y+1)\n  \n  x <- x[sapply(x, \\(j) between(j, 1, ncol))]\n  y <- y[sapply(y, \\(j) between(j, 1, nrow))]\n\n  expand.grid(\"col\" = x, \"row\" = y) |>\n    filter(!(col == xx & row == yy)) |>\n    as.matrix()\n}\n\nfor(i in 1:100) {\n  octopus <- octopus + 1\n  \n  while(any(octopus > 9)) {\n    flash <- which(octopus > 9, arr.ind = TRUE)\n    octopus[octopus > 9] <- 0\n    for(x in 1:nrow(flash)) {\n      adj <- \n        get_adjacent(flash[x, \"col\"], flash[x, \"row\"], octopusCol, octopusRow)\n      \n      octopus[adj[,\"row\"], adj[,\"col\"]] <- \n        apply(octopus[adj[,\"row\"], adj[,\"col\"]], c(1, 2), \n              \\(x) { ifelse(x == 0, 0, x + 1) })\n    }\n  }\n  flash_counter <<- flash_counter + length(octopus[octopus == 0])\n}\nflash_counter\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1603\n```\n:::\n:::\n\n\n## Part 2\n\n\n::: {.cell hash='2021-11_cache/html/unnamed-chunk-4_f944d92d7d5ec8110a003c36774b4bf0'}\n\n```{.r .cell-code}\noctopus <- octopusM |>\n  strsplit(\"\") %>%\n  do.call(rbind, .) |>\n  as.matrix() |>\n  apply(1, as.numeric) |>\n  t()\n\ni <- 1\n\nwhile(TRUE) {\n  octopus <- octopus + 1\n  \n  while(any(octopus > 9)) {\n    flash <- which(octopus > 9, arr.ind = TRUE)\n    octopus[octopus > 9] <- 0\n    for(x in 1:nrow(flash)) {\n      adj <- \n        get_adjacent(flash[x, \"col\"], flash[x, \"row\"], octopusCol, octopusRow)\n      \n      octopus[adj[,\"row\"], adj[,\"col\"]] <- \n        apply(octopus[adj[,\"row\"], adj[,\"col\"]], c(1, 2), \n              \\(x) { ifelse(x == 0, 0, x + 1) })\n    }\n  }\n  if (length(octopus[octopus == 0]) == octopusRow * octopusCol) {\n    print(i)\n    break\n  } else { i <- i + 1 }\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 222\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}