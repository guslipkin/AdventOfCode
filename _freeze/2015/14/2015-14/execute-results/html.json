{
  "hash": "911e8c14bdab38cfbd275188fc57f91d",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"14: Reindeer Olympics\"\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(mistlecode)\ndt <- \n  fread(\"input2.txt\", sep = \" \") |>\n  select(V1, V4, V7, V14) |>\n  `colnames<-`(c(\"reindeer\", \"speed\", \"flight_time\", \"rest_time\"))\nsec <- 2503\n```\n:::\n\n\n\n\nThis bit was added after Part 1 was completed because it's reused in Part 2.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndo_part <- function(dt) {\n  dt |>\n  uncount(speed, .remove = FALSE, .id = \"distance\") |>\n  filter(distance <= flight_time) |>\n  mutate(total_time = flight_time + rest_time) |>\n  uncount(total_time, .id = \"total_time\") |>\n  filter(distance == 1) |>\n  mutate(distance = ifelse(total_time <= flight_time, speed, 0)) |>\n  pivot_wider(\n    id_cols = total_time,\n    names_from = reindeer,\n    values_from = distance\n  ) |>\n  bind_rows(data.frame(\n    \"total_time\" = rep(NA_integer_, sec - max(dt$flight_time + dt$rest_time))\n  )) |>\n  mutate(\n    total_time = row_number(),\n    across(\n      -total_time, \n      \\(x) {\n        len_x <- length(x)\n        x <- na.omit(x)\n        rep(x, ceiling(sec / length(x)))[1:sec]\n      }\n    )\n  )\n}\n```\n:::\n\n\n\n\n\n## Part 1\n\nThis was super annoying. My first version of my `.qmd` file was corrupted\nsomehow so I could only run anything once after restarting RStudio. I thought it\nwas because I had just updated to R 4.3 but deleting the old file and pasting\neverything into a new one seems to have fixed it.\n\nAnyways, easy enough. Just a little annoying to get the vector recycling to line\nup how I wanted it to.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndt |>\n  do_part() |>\n  select(-total_time) |>\n  map_int(sum, na.rm = TRUE) |>\n  max()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 2660\n```\n\n\n:::\n:::\n\n\n\n\n## Part 2\n\nThis looks simple enough to change Part 1.\n\nI ended up not changing the parts I thought I would\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndt |>\n  do_part() |>\n  pivot_longer(\n    cols = -total_time,\n    names_to = \"reindeer\",\n    values_to = \"distance\"\n  ) |>\n  arrange(reindeer, total_time) |>\n  mutate(total_distance = cumsum(distance), .by = reindeer) |>\n  mutate(\n    points = ifelse(total_distance == max(total_distance), 1, 0), \n    .by = total_time\n  ) |>\n  mutate(total_points = cumsum(points), .by = reindeer) |>\n  filter(total_time == sec) |>\n  pull(total_points) |>\n  max()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1564\n```\n\n\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}