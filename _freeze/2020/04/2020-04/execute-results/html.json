{
  "hash": "1c64595c344670a930e5533cbbcf86fd",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Passport Processing\"\nformat: html\ndate: \"2020-12-04\"\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(readxl)\n\ndf <- read_excel(\"input.xls\")\ndf\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1,169 × 8\n   X1         X2          X3            X4         X5    X6    X7    X8   \n   <chr>      <chr>       <chr>         <chr>      <chr> <chr> <chr> <chr>\n 1 byr:2024   iyr:2016    <NA>          <NA>       <NA>  <NA>  <NA>  <NA> \n 2 eyr:2034   ecl:zzz     pid:985592671 hcl:033b48 <NA>  <NA>  <NA>  <NA> \n 3 hgt:181    cid:166     <NA>          <NA>       <NA>  <NA>  <NA>  <NA> \n 4 <NA>       <NA>        <NA>          <NA>       <NA>  <NA>  <NA>  <NA> \n 5 hgt:66cm   <NA>        <NA>          <NA>       <NA>  <NA>  <NA>  <NA> \n 6 pid:152cm  <NA>        <NA>          <NA>       <NA>  <NA>  <NA>  <NA> \n 7 hcl:cfb18a eyr:1947    <NA>          <NA>       <NA>  <NA>  <NA>  <NA> \n 8 byr:2020   ecl:zzz     iyr:2029      <NA>       <NA>  <NA>  <NA>  <NA> \n 9 <NA>       <NA>        <NA>          <NA>       <NA>  <NA>  <NA>  <NA> \n10 ecl:gry    hcl:#888785 eyr:2023      cid:63     <NA>  <NA>  <NA>  <NA> \n# ℹ 1,159 more rows\n```\n\n\n:::\n:::\n\n\n\n\n## Part 1\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncount <- 0\n\ntestDF <- df[1,]\n\nrow <- 1\ncolumn <- 1\nfor(r in 1:1169) {\n  for(c in 1:8) {\n    if(c == 1 & is.na(df[r,c])) {\n      column <- 1\n      row <- row + 1\n    }\n    if(!is.na(df[r,c])) {\n      testDF[row,column] <- df[r,c]\n      column <- column + 1\n    }\n  }\n}\n\npassports <- testDF\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncount <- 0\n\nfor(r in 1:299) {\n  if(rowSums(is.na(passports[r,])) == 0)\n      count <- count + 1\n  else if(!(apply(passports[r,], 1, function(x) {\n      any(substr(x, 1, 3) %in% \"cid\")\n    })) & rowSums(is.na(passports[r,])) == 1)\n      count <- count + 1\n}\ncount\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 247\n```\n\n\n:::\n:::\n\n\n\n\n## Part 2\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncount <- 0\ndone <- FALSE\nfields <- c(\"byr\", \"iyr\", \"eyr\", \"hgt\", \"hcl\", \"ecl\", \"pid\", \"cid\")\nneeded <- c(\"byr\", \"iyr\", \"eyr\", \"hgt\", \"hcl\", \"ecl\", \"pid\")\npassport <- c()\n\ntestDF <- df[1,]\n\nrow <- 1\ncolumn <- 1\nfor(r in 1:1169) {\n  for(c in 1:8) {\n    if(c == 1 & is.na(df[r,c])) {\n      column <- 1\n      row <- row + 1\n    }\n    if(!is.na(df[r,c])) {\n      testDF[row,column] <- df[r,c]\n      column <- column + 1\n    }\n  }\n}\n\npassports <- testDF\npassports\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 299 × 8\n   X1          X2            X3            X4            X5    X6    X7    X8   \n   <chr>       <chr>         <chr>         <chr>         <chr> <chr> <chr> <chr>\n 1 byr:2024    iyr:2016      eyr:2034      ecl:zzz       pid:… hcl:… hgt:… cid:…\n 2 hgt:66cm    pid:152cm     hcl:cfb18a    eyr:1947      byr:… ecl:… iyr:… <NA> \n 3 ecl:gry     hcl:#888785   eyr:2023      cid:63        iyr:… hgt:… pid:… <NA> \n 4 pid:#5e832a ecl:dne       hcl:#7d3b0c   byr:2018      eyr:… hgt:… iyr:… cid:…\n 5 hcl:#888785 ecl:oth       eyr:2025      pid:597580472 iyr:… hgt:… byr:… cid:…\n 6 eyr:2029    cid:145       iyr:2026      pid:178cm     hgt:… ecl:… hcl:… byr:…\n 7 eyr:2024    ecl:amb       pid:349191561 iyr:2018      hgt:… byr:… hcl:… <NA> \n 8 byr:1998    pid:408617933 hcl:#fffffd   hgt:193cm     eyr:… ecl:… iyr:… <NA> \n 9 eyr:1964    byr:2026      hcl:#cfa07d   hgt:154cm     pid:… cid:… iyr:… ecl:…\n10 hgt:161cm   pid:021086946 iyr:2020      ecl:blu       eyr:… byr:… <NA>  <NA> \n# ℹ 289 more rows\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmatt <- passports[1,]\nmatt$valid <- NA\n\nfor(r in 1:299) {\n  temp <- passports[r,]\n  if(rowSums(is.na(passports[r,])) == 0 | \n     !(apply(passports[r,], 1, function(x) any(substr(x, 1, 3) %in% \"cid\"))) & \n     rowSums(is.na(passports[r,])) == 1)\n    temp$valid <- TRUE\n  else\n    temp$valid <- FALSE\n  matt <- rbind(matt, temp)\n}\nmatt <- matt[-1,]\n\nnewmatt <- matt[1,]\n\nfor(r in 1:299) {\n  for(c in 1:8) {\n    if(!is.na(matt[r,c])) {\n      if(substr(matt[r,c], 1, 3) == \"byr\")\n        newmatt[r,1] <- matt[r,c]\n      \n      else if(substr(matt[r,c], 1, 3) == \"iyr\") \n        newmatt[r,2] <- matt[r,c]\n      \n      else if(substr(matt[r,c], 1, 3) == \"eyr\")\n        newmatt[r,3] <- matt[r,c]\n      \n      else if(substr(matt[r,c], 1, 3) == \"hgt\") \n        newmatt[r,4] <- matt[r,c]\n    \n      else if(substr(matt[r,c], 1, 5) == \"hcl:#\") \n        newmatt[r,5] <- matt[r,c]\n      \n      else if(substr(matt[r,c], 1, 3) == \"ecl\") \n        newmatt[r,6] <- matt[r,c]\n      \n      else if(substr(matt[r,c], 1, 3) == \"pid\") \n        newmatt[r,7] <- matt[r,c]\n      \n      else if(substr(matt[r,c], 1, 3) == \"cid\")\n        newmatt[r,8] <- matt[r,c]\n      \n    }\n    else\n      newmatt[r,c] <- NA\n  }\n  newmatt[r,9] <- matt[r,9]\n}\n\n#sorted <- sorted[-1,]\n\nnewmatt$X1 <- str_replace_all(newmatt$X1, \"[a-z:]\", \"\")\nnewmatt$X2 <- str_replace_all(newmatt$X2, \"[a-z:]\", \"\")\nnewmatt$X3 <- str_replace_all(newmatt$X3, \"[a-z:]\", \"\")\nnewmatt$X4 <- substr(newmatt$X4, 5, nchar(newmatt$X4))\nnewmatt$X5 <- substr(newmatt$X5, 5, nchar(newmatt$X5))\nnewmatt$X6 <- substr(newmatt$X6, 5, nchar(newmatt$X6))\nnewmatt$X7 <- substr(newmatt$X7, 5, nchar(newmatt$X7))\nnewmatt$X8[!is.na(newmatt$X8)] <- TRUE\n\nnewmatt$X1 <- as.numeric(newmatt$X1)\nnewmatt$X2 <- as.numeric(newmatt$X2)\nnewmatt$X3 <- as.numeric(newmatt$X3)\n#newmatt$X7 <- as.numeric(newmatt$X7)\n\nnewmatt <- newmatt %>% filter(valid == TRUE)\nnewmatt$valid <- TRUE\n\n#the ants go marching one by one...\nnewmatt$flag <- 0\n\nnewmatt$valid <- ifelse(newmatt$X1 >= 1920 & newmatt$X1 <= 2002 & \n                          newmatt$valid == TRUE, TRUE, FALSE) #197\nnewmatt$valid <- ifelse(newmatt$X2 >= 2010 & newmatt$X2 <= 2020 & \n                          newmatt$valid == TRUE, TRUE, FALSE) #174\nnewmatt$valid <- ifelse(newmatt$X3 >= 2020 & newmatt$X3 <= 2030 & \n                          newmatt$valid == TRUE, TRUE, FALSE) #160\nnewmatt$flag <- \n  ifelse(newmatt$valid == TRUE & grepl(\"cm\", newmatt$X4) & \n           as.numeric(str_replace_all(newmatt$X4, \"[a-z]\", \"\")) >= 150 & \n           as.numeric(str_replace_all(newmatt$X4, \"[a-z]\", \"\")) <= 193, \n         newmatt$flag + 1, newmatt$flag)\nnewmatt$flag <- \n  ifelse(newmatt$valid == TRUE & grepl(\"in\", newmatt$X4) & \n           as.numeric(str_replace_all(newmatt$X4, \"[a-z]\", \"\")) >= 59 & \n           as.numeric(str_replace_all(newmatt$X4, \"[a-z]\", \"\")) <= 76, \n         newmatt$flag + 1, newmatt$flag)\nnewmatt$valid <- ifelse(newmatt$flag == 1, TRUE, FALSE)\nnewmatt$valid <- \n  ifelse(substr(newmatt$X5, 1, 1) == \"#\" & \n           grepl(\"[0-9a-f#]\", substr(newmatt$X5, 2, nchar(newmatt$X5) - 1)) & \n           nchar(newmatt$X5) == 7 & newmatt$valid == TRUE, TRUE, FALSE)\nnewmatt$valid <- \n  ifelse(grepl(\"(amb|blu|brn|gry|grn|hzl|oth)\", newmatt$X6) & \n           newmatt$valid == TRUE, TRUE, FALSE)\nnewmatt$valid <- \n  ifelse(nchar(newmatt$X7) == 9 & grepl(\"[0-9]\", newmatt$X7) & \n           newmatt$valid == TRUE, TRUE, FALSE)\n\nnewmatt %>%\n  filter(valid == TRUE) %>%\n  nrow()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 145\n```\n\n\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}