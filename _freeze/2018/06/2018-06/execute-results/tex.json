{
  "hash": "43e2469a4f7d91543329712797e3de59",
  "result": {
    "markdown": "# 2018-06: Chronal Coordinates\n\n\n\n::: {.cell hash='2018-06_cache/pdf/unnamed-chunk-1_69783f9f6894903555ddc4f902783b8d'}\n\n```{.r .cell-code}\nlibrary(data.table)\nlibrary(dbscan)\nlibrary(factoextra)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: ggplot2\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWelcome! Want to learn more? See two factoextra-related books at https://goo.gl/ve3WBa\n```\n:::\n:::\n\n::: {.cell hash='2018-06_cache/pdf/unnamed-chunk-2_0cd18f2a4c35b89e58a0f21d9e579bba'}\n\n```{.r .cell-code}\ndt <- fread(\"input.txt\")\ncolnames(dt) <- c(\"x\", \"y\")\ndt$x <- dt$x + 1\ndt$y <- dt$y + 1\ndt$id <- 1:nrow(dt)\nhead(dt)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     x   y id\n1: 109 325  1\n2:  47  92  2\n3: 357 217  3\n4: 210 170  4\n5: 171 332  5\n6: 333 216  6\n```\n:::\n:::\n\n\n\n## Part 1\n\n\n\n::: {.cell hash='2018-06_cache/pdf/unnamed-chunk-3_8864ae36b8adabdcd6810004207835f9'}\n\n```{.r .cell-code}\nsize <- max(max(dt$x), max(dt$y))\nmat <- matrix(NA, size, size)\nmat[as.matrix(dt[, 1:2])] <- dt$id\n\nfor(x in 1:ncol(mat)) {\n  for(y in 1:nrow(mat)) {\n    distX <- abs(x - dt$x)\n    distY <- abs(y - dt$y)\n    dist <- (distX + distY) / 2\n    closest <- dist[dist == min(dist)]\n    mat[x,y] <- ifelse(length(closest) == 1, which.min(dist), NA)\n  }\n}\n\nedges <- unique(c(mat[1, ], mat[,1], mat[nrow(mat), ], mat[, ncol(mat)]))\nmat[mat %in% edges] <- NA\nmax(table(mat))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 4166\n```\n:::\n:::\n\n\n\n## Part 2\n\n\n\n::: {.cell hash='2018-06_cache/pdf/unnamed-chunk-4_ac2ecb56fa457a533a6106dbb7bbac75'}\n\n```{.r .cell-code}\ngrid <- expand.grid(1:size, 1:size)\nsapply(1:nrow(grid), function(i) {\n  dist <- abs(dt$x - grid$Var1[i]) + abs(dt$y - grid$Var2[i])\n  if(sum(dist) < 10000) { return(i) }\n  else { return(NA) }\n}) |> \n  na.exclude() |>\n  length()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 42250\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{},\"value\":[]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}