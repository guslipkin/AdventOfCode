{
  "hash": "dedad3e52f5c1d19334bdf078493aaba",
  "result": {
    "markdown": "---\ntitle: \"2018-04: Repose Record\"\nformat: html\n---\n\n::: {.cell hash='2018-04_cache/html/unnamed-chunk-1_2134fe4e01df1e9af156b7b001e53338'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──\n✔ ggplot2 3.3.6      ✔ purrr   0.3.4 \n✔ tibble  3.1.8      ✔ dplyr   1.0.10\n✔ tidyr   1.2.0      ✔ stringr 1.4.1 \n✔ readr   2.1.2      ✔ forcats 0.5.2 \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n```\n:::\n\n```{.r .cell-code}\nlibrary(data.table)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'data.table'\n\nThe following objects are masked from 'package:dplyr':\n\n    between, first, last\n\nThe following object is masked from 'package:purrr':\n\n    transpose\n```\n:::\n\n```{.r .cell-code}\nlibrary(stringi)\n```\n:::\n\n::: {.cell hash='2018-04_cache/html/unnamed-chunk-2_86da8888be53fe35e218fe4d960dca3e'}\n\n```{.r .cell-code}\ndt <- readLines(\"input.txt\")\npattern <- \"\\\\[([0-9]{4}-[0-9]{2}-[0-9]{2} [0-9]{2}:[0-9]{2})\\\\] (.*)\"\ndt <- data.table(do.call(rbind, stri_match_all_regex(dt, pattern)))\ncolnames(dt) <- c(\"input\", \"time\", \"action\")\ndt$guard <- as.numeric(do.call(rbind, stri_match_all_regex(dt$action, \"[0-9]{3,4}\")))\ndt$time <- as.POSIXct(dt$time)\ndt$action <- ifelse(dt$action == \"falls asleep\", \"asleep\", \"awake\")\ndt <- dt[order(time)] |> \n  fill(guard) |>\n  select(-input) |>\n  mutate(minute = minute(time), day = as.Date(time)) |>\n  filter(hour(time) == 0)\n```\n:::\n\n\n## Part 1\n\n\n::: {.cell hash='2018-04_cache/html/unnamed-chunk-3_a0745c66865a165ed89b801f2a4be698'}\n\n```{.r .cell-code}\ndata.table(\"day\" =\n             rep(seq.Date(as.Date(min(dt$time)), \n                          as.Date(max(dt$time)), \n                          by = \"day\"), \n                 each = 60),\n           \"minute\" = 0:59) |>\n  left_join(dt, by = c(\"day\", \"minute\")) |>\n  select(-time) |>\n  arrange(day, minute) |>\n  fill(action, guard) |>\n  filter(action == \"asleep\") |>\n  dcast(guard ~ minute, value.var = \"action\", fun.aggregate = length) -> saved\nsaved %>%\n  mutate(total = rowSums(.) - guard) |>\n  filter(total == max(total)) |>\n  select(-total) |>\n  as.vector() |>\n  unlist() -> vec\n\nunname(vec[\"guard\"] * as.numeric(names(which.max(vec[-1]))))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 146622\n```\n:::\n:::\n\n\n## Part 2\n\n\n::: {.cell hash='2018-04_cache/html/unnamed-chunk-4_7c3e6e015f7d75e5513bd5fc603856e4'}\n\n```{.r .cell-code}\nsaved |>\n  pivot_longer(cols = matches(\"[0-9]{1,2}\"), names_to = \"minute\", values_to = \"times\") |>\n  filter(times == max(times)) |>\n  mutate(value = guard * as.numeric(minute)) |>\n  pull(value)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 31848\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}