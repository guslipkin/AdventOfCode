{
  "hash": "e7ff343265bd26fceecaef9556f271fc",
  "result": {
    "markdown": "---\ntitle: \"2016-01: No Time for a Taxicab\"\nformat: html\n---\n\n::: {.cell hash='2016-01_cache/html/unnamed-chunk-1_242dacb6d0404b71a2ec068a482f2826'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──\n✔ ggplot2 3.4.0      ✔ purrr   0.3.5 \n✔ tibble  3.1.8      ✔ dplyr   1.0.10\n✔ tidyr   1.2.1      ✔ stringr 1.4.1 \n✔ readr   2.1.3      ✔ forcats 0.5.2 \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n```\n:::\n\n```{.r .cell-code}\nlibrary(data.table)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'data.table'\n\nThe following objects are masked from 'package:dplyr':\n\n    between, first, last\n\nThe following object is masked from 'package:purrr':\n\n    transpose\n```\n:::\n\n```{.r .cell-code}\nlibrary(stringr)\n```\n:::\n\n::: {.cell hash='2016-01_cache/html/unnamed-chunk-2_df1d17bf51143f27ad763f0ecde16e8c'}\n\n```{.r .cell-code}\ndt <- readLines(\"input.txt\") |> \n  str_split(\", \", simplify = FALSE) |> \n  unlist() |>\n  str_match_all(\"([RL])([0-9]*)\") |> \n  list() |> \n  rbindlist() |>\n  t() |>\n  data.table() |>\n  `colnames<-`(c(\"input\", \"dir\", \"dis\")) |>\n  mutate(dis = as.integer(dis))\nhead(dt)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   input dir dis\n1:    R4   R   4\n2:    R5   R   5\n3:    L5   L   5\n4:    L5   L   5\n5:    L3   L   3\n6:    R2   R   2\n```\n:::\n:::\n\n\n## Part 1\n\n\n::: {.cell hash='2016-01_cache/html/unnamed-chunk-3_a21ad2421a62627f46683ab1784bc58f'}\n\n```{.r .cell-code}\ndt$deg <- 0\nfor(i in 2:nrow(dt)) {\n  if(dt$dir[i] == \"R\") { dt$deg[i] <- dt$deg[i-1] + 90 }\n  else {dt$deg[i] <- dt$deg[i-1] - 90}\n}\ndt |>\n  mutate(deg = deg %% 360, \n         dis = ifelse(deg %in% c(180, 270), -dis, dis)) |>\n  group_by(deg) |>\n  summarise(n = sum(dis)) |>\n  pull(n) |>\n  sum()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 250\n```\n:::\n:::\n\n\n## Part 2\n\n\n::: {.cell hash='2016-01_cache/html/unnamed-chunk-4_5982c1b99fb1777a961d185c7396fb60'}\n\n```{.r .cell-code}\npoints <- matrix(c(ifelse(dt$dir[1] == \"R\", dt$dis[1], -dt$dis[1]), 0), 1, 2)\nfor (j in 2:nrow(dt)) {\n  tmp <- dt[1:j,]\n  tmp$deg <- 0\n  for (i in 2:j) {\n    if (tmp$dir[i] == \"R\") { tmp$deg[i] <- tmp$deg[i - 1] + 90 }\n    else {  tmp$deg[i] <- tmp$deg[i - 1] - 90 }\n  }\n  tmp |>\n    mutate(deg = deg %% 360,\n           dis = ifelse(deg %in% c(180, 270), -dis, dis)) |>\n    group_by(deg) |>\n      summarise(n = sum(dis)) |>\n      ungroup() |>\n    mutate(deg = ifelse(deg %% 360 %in% c(0, 180), TRUE, FALSE)) |>\n    group_by(deg) |>\n      summarise(n = sum(n)) |>\n      ungroup() |>\n    pull(n) -> point\n  points <- rbind(points, unname(point))\n}\npoints <- rbind(t(c(0, 0)), points)\n\ntmp <- t(c(NA, NA))\n\nfor(i in 1:(nrow(points) - 1)) {\n  tmp <- \n    rbind(tmp, cbind(points[i,1]:points[i+1,1], points[i,2]:points[i+1,2]))\n}\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in cbind(points[i, 1]:points[i + 1, 1], points[i, 2]:points[i + : number\nof rows of result is not a multiple of vector length (arg 1)\n```\n:::\n\n```{.r .cell-code}\ntmp <- tmp[-1,]\nfor(i in 1:(nrow(tmp) - 1)) {\n  if(all(tmp[i,] == tmp[i+1,])) {\n    tmp[i,] <- t(c(NA, NA))\n  }\n}\ntmp <- na.omit(tmp)\nsum(tmp[duplicated(tmp),][1,])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 151\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}